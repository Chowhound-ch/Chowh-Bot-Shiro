package per.chowh.bot.utils;import lombok.extern.slf4j.Slf4j;import okhttp3.OkHttpClient;import org.springframework.beans.factory.annotation.Value;import org.springframework.boot.ApplicationArguments;import org.springframework.boot.ApplicationRunner;import org.springframework.stereotype.Component;import java.io.IOException;import java.net.InetSocketAddress;import java.net.Proxy;import java.time.Duration;/** * @author : Chowhound * @since : 2025/10/21 - 14:46 */@Slf4j@Componentpublic class HttpProxyUtils implements ApplicationRunner {    @Value("${per.network.proxy.host}")    private String host;    @Value("${per.network.proxy.port}")    private Integer port;    private static OkHttpClient BASE_CLIENT;    public static String doGetStr(String url) throws IOException {        return HttpUtils.doGetStr(BASE_CLIENT, url, null);    }    public static byte[] doGetBytes(String url) throws IOException {        return HttpUtils.doGetBytes(BASE_CLIENT, url, null);    }    // 启动之后才真正切换到代理    @Override    public void run(ApplicationArguments args) throws Exception {        Proxy proxy = new Proxy(Proxy.Type.HTTP, new InetSocketAddress(host, port));        BASE_CLIENT = new OkHttpClient.Builder()                .proxy(proxy)                .callTimeout(Duration.ofSeconds(60))                .connectTimeout(Duration.ofSeconds(60))                .readTimeout(Duration.ofSeconds(60))                .writeTimeout(Duration.ofSeconds(60))                .build();        log.info("HttpProxyUtils切换为代理模式 host: {}, port: {}",  host, port);    }}